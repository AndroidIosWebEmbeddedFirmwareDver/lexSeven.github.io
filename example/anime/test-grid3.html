<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        html,body{
            height: 100%;
        }
        body{
            margin: 0;
            display: flex;
            justify-content: center;
        }
        .wraper{
            width: 80%;
            height: 80%;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: auto;
        }
        .box{
            display: grid;
            grid-template-columns: repeat(21,40px);
            grid-template-rows: repeat(21,40px);
            /*grid-gap: 1px;*/
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            margin: auto;
            transform-style: preserve-3d;
        }

        .item{
            background: #899;
            /*border-radius: 2px;*/
        }
    </style>
    <script src="js/anime.js"></script>
</head>
<body>
<!--<div class="wraper"></div>-->
<div class="box"><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span><span class="item"></span><span class="item"></span><span
        class="item"></span><span class="item"></span></div>

<script>
    // anime({
    //     targets: '.box .item',
    //     scale: [
    //         {value: .1, easing: 'easeOutSine', duration: 500},
    //         {value: 1, easing: 'easeInOutQuad', duration: 1000}
    //     ],
    //     delay: anime.stagger(200, {grid: [20, 20], from: 1}),
    //     // loop:true
    // });
    const grid = [21, 21];

    let getColor = function(){
        return 'rgba('+Math.floor(Math.random()*255)+','+Math.floor(Math.random()*255)+','+Math.floor(Math.random()*255)+','+Math.random()+')'
    };

    document.querySelectorAll('.item').forEach(function(item,index){

        item.onclick = function(){
            const staggersAnimation = anime.timeline({
                targets: '.box .item',
                easing: 'easeInOutSine',
                delay: anime.stagger(50),
                loop: false,
                autoplay: false
            })
            .add({
                translateX: [
                    {value: anime.stagger('-.1rem', {grid: grid, from: index, axis: 'x'}) },
                    {value: anime.stagger('.1rem', {grid: grid, from: index, axis: 'x'}) },
                    {value: anime.stagger('0', {grid: grid, from: index, axis: 'x'}) }
                ],
                translateY: [
                    {value: anime.stagger('-.1rem', {grid: grid, from: index, axis: 'y'}) },
                    {value: anime.stagger('.1rem', {grid: grid, from: index, axis: 'y'}) },
                    {value: anime.stagger('0', {grid: grid, from: index, axis: 'y'}) }
                ],
                translateZ: [
                    {value: .1, easing: 'easeOutSine', duration: 500},
                    {value: 1.05, easing: 'easeInOutQuad', duration: 1000},
                    {value: .6, easing: 'easeOutSine', duration: 500,delay:80},
                    {value: 1.02, easing: 'easeInOutQuad', duration: 800},
                    {value: 0.97, easing: 'easeInOutQuad', duration: 200},
                    {value: 1, easing: 'easeInOutQuad', duration: 200}
                ],
                scale: [
                    {value: .1, easing: 'easeOutSine', duration: 500},
                    {value: 1.05, easing: 'easeInOutQuad', duration: 1000},
                    {value: .6, easing: 'easeOutSine', duration: 500,delay:80},
                    {value: 1.02, easing: 'easeInOutQuad', duration: 800},
                    {value: 0.97, easing: 'easeInOutQuad', duration: 200},
                    {value: 1, easing: 'easeInOutQuad', duration: 200}
                ],
                // background:getColor(),
                duration: 1000,
                delay: anime.stagger(100, {grid: grid, from: index})
            })

            staggersAnimation.play();
        }
    });
</script>

</body>
</html>
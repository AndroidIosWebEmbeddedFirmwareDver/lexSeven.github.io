<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>lexSeven Visual</title>
<link href="css/style.css" rel="stylesheet" type="text/css">
<link href="images/icon.ico" rel="icon" />
</head>

<body>

<div class="box">
	<div class="dot dot1"><img src="images/dot1.png"></div>
    <div class="dot dot2"><img src="images/dot2.png"></div>
    <div class="dot dot3"><img src="images/dot3.png"></div>
    <div class="dot dot4"><img src="images/dot4.png"></div>
    <div class="dot dot5"><img src="images/dot5.png"></div>
    <div class="dot dot6"><img src="images/dot6.png"></div>
    <div class="dot dot7"><img src="images/dot7.png"></div>
    <div class="dot dot8"><img src="images/dot8.png"></div>
    <div class="dot dot9"><img src="images/dot9.png"></div>
    <div class="dot dot10"><img src="images/dot1.png"></div>
    <div class="dot dot11"><img src="images/dot1.png"></div>
    <div class="dot dot12"><img src="images/dot2.png"></div>
    <div class="dot dot13"><img src="images/dot3.png"></div>
    <div class="dot dot14"><img src="images/dot4.png"></div>
    <div class="dot dot15"><img src="images/dot5.png"></div>
    <div class="dot dot16"><img src="images/dot6.png"></div>
    <div class="logo"><img src="images/logo.png"></div>
</div>

<div class="menu" id="menu">
	<div id="Mclose" class="M_close"></div>
    <ul>
    	<li><a href="index.html">网站首页</a></li>
        <li><a href="case.html">案例展示</a></li>
        <li><a href="inf.html">个人信息</a></li>
        <li><a href="#">个人收藏</a></li>
    </ul>
</div>

<div class="tell">
    <div class="number"><span>Tel</span><i>QQ 305346765 / 1867399124</i></div>
    <div class="copy">Width Our Young Sitll Has A Dream! Lex Visual  Copyright:BeiJing Lex Visual Technology Development.,LTD</div>
</div>

<div class="case1"><div class="case2">
<div class="case3">&nbsp;</div>
	<img src="images/case_01.jpg" />
</div></div>

</body>
<script src="js/zepto.min.js"></script>
<script>
var lexSeven = {
	int:function(){
		var _this = lexSeven;
		_this.nowMusic = 0;
		$('body').height($(window).height());
		_this.bindEvent();
		_this.playMusic(_this.bgmusic[_this.nowMusic++]);
	},
	bindEvent:function(){
		var _this = lexSeven;
		
		$(document).on('touchstart',function(ev){
			
            for(a in _this.clickArea){
                if($(ev.target).data('function')==a){
                    _this.clickArea[a]($(ev.target));
					break;
                }
            }
        });
		
	},
	bgmusic:[
		'music/b.mp3',
		'music/Remix.mp3',
		'music/mo.mp3',
		'music/Neptune Illusion Dennis Kuo .mp3'
	],
	playMusic:function( music ){
		var _this = lexSeven;
		var aImg = $('.dot');
		_this.audio = new Audio();
		var audioContext,analyser,sourceNode,freqArray,nowbtn,num,k,m,n;
		int()
		function int(){
			_this.audio.pause();
			_this.audio = null;
			_this.audio = new Audio();
			_this.audio.src = music;
		}
		_this.audio.addEventListener("canplay", function(e) {
			analyser = sourceNode = null;
			setup();
		}, false);
		function setup() {
			audioContext = audioContext || new AudioContext();
			analyser = (analyser || audioContext.createAnalyser());
			sourceNode = audioContext.createMediaElementSource(_this.audio);
			sourceNode.connect(analyser);
			sourceNode.connect(audioContext.destination);
			_this.audio.play();
			update();
		};
		function update() {
			freqArray = new Uint8Array(analyser.frequencyBinCount);
			analyser.getByteFrequencyData(freqArray);
			fn(freqArray);
			if(_this.audio.paused){
				freqArray = null;
				_this.playMusic(_this.bgmusic[_this.nowMusic++]);
			}else{
				requestAnimationFrame(update);
			}
		};
		function fn(arr){
			var step = Math.round(arr.length / 50); 
			for( var i = 0; i < 16; i++ ){
				num = arr[i * step];
				k = (num) / aImg[i].offsetHeight * 100;
				m = 100 - k;
				//n = (m-80)>0?(m-80):0;
				aImg.eq(i).get(0).style.cssText = "margin-top:" + m + "px";
			}
		}
	}
}
lexSeven.int();
</script>
</html>
